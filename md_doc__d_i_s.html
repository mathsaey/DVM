<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DVM: DIS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DVM
   &#160;<span id="projectnumber">aa7fe16</span>
   </div>
   <div id="projectbrief">DataFlow Virtual Machine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">DIS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#General">General</a><ul><li class="level2"><a href="#Memory">The Instruction Memory.</a></li>
</ul>
</li>
<li class="level1"><a href="#Layout">DIS file layout</a><ul><li class="level2"><a href="#Chunks">Chunks</a></li>
<li class="level2"><a href="#Links">Links</a></li>
<li class="level2"><a href="#Instructions">Instructions</a></li>
</ul>
</li>
<li class="level1"><a href="#Entry">Entry and Exit point</a></li>
<li class="level1"><a href="#Example">An Example</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="General"></a>
General</h1>
<p>This page defines the standard of DIS, the DVM Instruction Set. DIS is the only input accepted by DVM, and can be generated by an external tool. As the name might say, DIS simply contains the instruction set that DVM uses to execute programs. Simply said, DIS is a string representation of the DVM instruction memory.</p>
<h2><a class="anchor" id="Memory"></a>
The Instruction Memory.</h2>
<p>Seeing that DIS is a string version of the instruction memory, it might be handy to know what the instruction memory looks like.</p>
<p>The DVM instruction memory is divided into <b>chunks</b>, each of these chunks contains instructions that have certain properties. At the time of writing, the instruction memory contains 2 chunks, instructions that need to be matched by the context matcher and instructions that don't need to be matched.</p>
<p>The instructions that don't need to be matched are located in chunk 0, while those that need to be matched are located in chunk 1.</p>
<h1><a class="anchor" id="Layout"></a>
DIS file layout</h1>
<p>A DIS file contains 3 types of statements, seperated by newlines.</p>
<ul>
<li>Chunck declarations</li>
<li>Instruction definitionss</li>
<li>Links between instructions.</li>
</ul>
<p>Besides these, DIS can contain comments, a comment is started by using <code>$</code></p>
<p>The following sections detail the exact nature of the other statements.</p>
<h2><a class="anchor" id="Chunks"></a>
Chunks</h2>
<p>Like the instruction memory, a DIS file is divided in chunks. A chunk simply contains all the instructions present in this chunk. A new chunk is started with the following statement: </p>
<pre class="fragment">CHUNCK &lt;idx&gt;
</pre><p>Where chunk is a keyword while idx is the index of the chunk. A chunk ends when a new chunk begins or when the file ends. It is not possible to nest chunks.</p>
<h2><a class="anchor" id="Links"></a>
Links</h2>
<p>A link allows us to define from-to relationships between instructions. A link is added in the following way: </p>
<pre class="fragment">LINK &lt;from&gt; &lt;to&gt;
</pre><p>Where LINK is a keyword while from is the address (chunk, instruction, port) of the port on the source node while to is the address of the port on the to node.</p>
<p>A port address is represented with the following syntax: </p>
<pre class="fragment">&lt;chunk&gt; &lt;instruction&gt; &lt;port&gt;
</pre><p>Thus a link from port 0 of instruction 3 in chunk 0 to port 0 of instruction 1 in chunk 1 would look like this: </p>
<pre class="fragment">LINK 0 3 0 0 1 0
</pre><p>Links can occur anywhere in the file, and transcend chunk boundaries. However, a link should never precede the declaration of it's source.</p>
<h2><a class="anchor" id="Instructions"></a>
Instructions</h2>
<p>An instruction in DIS looks like this: </p>
<pre class="fragment">INST &lt;type&gt; &lt;idx&gt; &lt;args&gt;
</pre><p>Where idx is the index of the instruction in the chunk of memory, while type is the type of instruction we are creating. Args represents the arguments. These depend on the type of instruction.</p>
<h3>Instructions Types</h3>
<p>The following table defines the possible instruction types, their type code and the argument string they accept. Additional explanation on each of these types can be found below.</p>
<table class="doxtable">
<tr>
<th>Type </th><th>Code </th><th>Args  </th></tr>
<tr>
<td><a class="el" href="classcore_1_1instruction_1_1_sink.html">Sink</a> </td><td>SI </td><td><code>None</code> </td></tr>
<tr>
<td><a class="el" href="classcore_1_1instruction_1_1_context_change.html">ContextChange</a> </td><td>CC </td><td><code>&lt;to&gt; &lt;return sink&gt;</code> </td></tr>
<tr>
<td><a class="el" href="classcore_1_1instruction_1_1_context_restore.html">ContextRestore</a> </td><td>CR </td><td><code>None</code> </td></tr>
<tr>
<td><a class="el" href="classcore_1_1instruction_1_1_operation_instruction.html">OperationInstruction</a> </td><td>OP </td><td><code>&lt;opCode&gt; &lt;inputs&gt;</code> </td></tr>
</table>
<h4>Sinks</h4>
<p>Sinks are the the simplest instruction that is available. A sink is a simple link between a from and to. It will send whatever input it receives on a port to the destination for that port.</p>
<p>Sinks are mainly used to have a static point in the program that can catch input (such as the start of a function). A sink takes no arguments, since it's behavior is defined by it's destinations, which are added through links.</p>
<h4>ContextChange</h4>
<p>A Context change instruction changes the context of a token. Look into the <a class="el" href="classcore_1_1instruction_1_1_context_change.html">documentation</a> for further information.</p>
<p>A context change instruction takes 2 arguments, the address to a sink, which will be the destination of any token that enters the instruction. And the address of a return sink, which will catch anything that is returned when the context is restored. Thus a context change will look like this: </p>
<pre class="fragment">INST CC &lt;idx&gt; &lt;address&gt; &lt;address&gt;
</pre><p>Such an address is similar to a link address: </p>
<pre class="fragment">&lt;chunk&gt; &lt;instruction&gt;
</pre><p>Thus a context change instruction is added in the following manner: </p>
<pre class="fragment">INST CC 2 0 4 0 3
</pre><h4>Context Restore</h4>
<p>A context Restore finds the return instruction of a token based on it's context and sends it to that location. It can be compared to a return from a call. Once again, we refer to the <a class="el" href="classcore_1_1instruction_1_1_context_restore.html">documentation</a> for additional information.</p>
<p>A context restore takes no arguments.</p>
<h4>Operation Instruction</h4>
<p>An operation instruction represents an operation on the data of a set of tokens. It takes an opcode, which represents the operation it performs, and a number detailing the amount of inputs it should receive. It ends up looking like this: </p>
<pre class="fragment">INST OP &lt;idx&gt; &lt;opCode&gt; &lt;inputs&gt;
</pre><p>Example: </p>
<pre class="fragment">INST OP 0 1 2
</pre><h1><a class="anchor" id="Entry"></a>
Entry and Exit point</h1>
<p>In order to communicate with the outside world, the DVM needs to have a predefined entry and exit point to the program. These are added by using a special instruction that can only be used for this purpose. These special instructions have to be placed at predefined locations.</p>
<p>The entry point of the program should be located in chunk 0 at address 0, while the exit point should be located at chunk 0 at address 0. These points are added through the program begin and program end points. Both of these take one additional argument, which represents the amount of tokens the program accepts/returns.</p>
<p>entry point: </p>
<pre class="fragment">INST PB 0 &lt;inputs&gt;
</pre><p>exit point: </p>
<pre class="fragment">INST PE 0 &lt;outputs&gt;
</pre><h1><a class="anchor" id="Example"></a>
An Example</h1>
<p>The example below presents the DIS code for a program that simply calls a function which adds both of it's inputs. It is roughly equivalent to the following pseudo code.</p>
<div class="fragment"><div class="line"><span class="keyword">function</span> <a class="code" href="namespacecore_1_1memory.html#adadafaa74f91e37b9c0d0f7bb51988f2">add</a>(x, y):</div>
<div class="line">    return x + y</div>
<div class="line">end function</div>
<div class="line"></div>
<div class="line">function Main(x, y):</div>
<div class="line">    return <a class="code" href="namespacecore_1_1memory.html#adadafaa74f91e37b9c0d0f7bb51988f2">add</a>(x,y)</div>
<div class="line">end function</div>
</div><!-- fragment --><div class="fragment"><div class="line">$ simple.dis</div>
<div class="line">$ Mathijs Saey</div>
<div class="line">$ A simple DIS Example</div>
<div class="line"></div>
<div class="line">CHUNCK 0</div>
<div class="line">$ Instructions without a matcher</div>
<div class="line"></div>
<div class="line">$ Program entry and exit point</div>
<div class="line">INST PB 0 2 $ Program entry point</div>
<div class="line">INST PE 1 1 $ Program exit  point</div>
<div class="line"></div>
<div class="line">$ <span class="stringliteral">&quot;main function&quot;</span></div>
<div class="line">INST CC 2 0 4 0 3 $ A call to a <span class="keyword">function</span>.</div>
<div class="line">INST SI 3         $ A sink that leads to the program exit point.</div>
<div class="line"></div>
<div class="line">LINK 0 0 0 0 2 0 $ Accept input from entry point</div>
<div class="line">LINK 0 0 1 0 2 1 $ Accept input from entry point</div>
<div class="line">LINK 0 3 0 0 1 0 $ Send <span class="keywordflow">return</span> value to program exit</div>
<div class="line"></div>
<div class="line">$ <span class="keyword">function</span></div>
<div class="line">INST SI 4 $ Entry sink of the <span class="keyword">function</span></div>
<div class="line">INST CR 5 $ Function <span class="keywordflow">return</span> </div>
<div class="line"></div>
<div class="line">LINK 0 4 0 1 0 0 $ Send input to operation</div>
<div class="line">LINK 0 4 1 1 0 1 $ Send input to operation</div>
<div class="line"></div>
<div class="line">CHUNCK 1</div>
<div class="line">$ Instructions that need the matcher</div>
<div class="line">INST OP 0 14 2</div>
<div class="line"></div>
<div class="line">LINK 1 0 0 0 5 0 $ Send output to <span class="keywordflow">return</span></div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 27 2014 21:52:45 for DVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
